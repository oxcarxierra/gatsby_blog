{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/usfk_bus_production_review","result":{"data":{"markdownRemark":{"id":"deb5e29d-b260-5f8c-86a7-e68f6ff46b4e","html":"<p>캠프 험프리스 내 셔틀버스 시간표 앱이 있으면 좋겠다는 의견이 있었다. 마침 App Store에는 Playstore만큼 좋은 퀄리티의 시간표 앱이 없어서 직접 제작해보기로 했다. 수요는 많이 없겠지만 작년에 열심히 썼던 React Native 복습 + 새로 배운 Django 프레임워크 활용을 연습해보는 목적이었다.</p>\n<h2 id=\"1-react-native\" style=\"position:relative;\"><a href=\"#1-react-native\" aria-label=\"1 react native permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. React Native</h2>\n<h3 id=\"forwardref의-사용\" style=\"position:relative;\"><a href=\"#forwardref%EC%9D%98-%EC%82%AC%EC%9A%A9\" aria-label=\"forwardref의 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>forwardRef()의 사용</h3>\n<p>Ref는 render 메서드에서 생성된 DOM 노드나 React 엘리먼트에 접근하는 방법을 제공한다. useRef 메소드로 ref를 생성해서 react-native-map, scrollview등의 컴포넌트에 쓸 수 있다. 이 때 다른 컴포넌트에서 이 Ref를 참조하고 조작하려 할 때 일반적인 Props로 넘겨주면 오류가 난다.\n이유는 <strong>함수 컴포넌트는 인스턴스가 없기 때문에 함수 컴포넌트에 ref 어트리뷰트를 사용할 수 없기 때문</strong>.</p>\n<p>이때는 React Native의 forwardRef() 메소드로 해당 컴포넌트를 감싸서 넘겨주어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>참고:\n<a href=\"https://merrily-code.tistory.com/121\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://merrily-code.tistory.com/121</a><br>\n<a href=\"https://ko.reactjs.org/docs/refs-and-the-dom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ko.reactjs.org/docs/refs-and-the-dom.html</a></p>\n<h3 id=\"install-react-native-reanimated\" style=\"position:relative;\"><a href=\"#install-react-native-reanimated\" aria-label=\"install react native reanimated permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>install react-native-reanimated</h3>\n<p>특정 library를 사용하기 위해 react-native-reanimated를 설치해야 했는데, 과정이 까다로워서 남겨둬야겠다.<br>\n당연히도 yarn또는 npm으로 설치 후 pod install까지 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">install</span> react-native-reanimated\n<span class=\"token builtin class-name\">cd</span> ios <span class=\"token operator\">&amp;&amp;</span> pod <span class=\"token function\">install</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></code></pre></div>\n<p>이후 babel.config.js를 아래처럼 수정해주어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// babel.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  presets<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'module:metro-react-native-babel-preset'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'react-native-reanimated/plugin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이후에 캐시를 삭제하고 다시 시도해봐도 설치 오류가 나서 헤맸는데, 결국 답은 맥북 다시시작이었다… 껐다 키니까 빌드가 성공하는 매직!<br>\n참고 : <a href=\"https://github.com/software-mansion/react-native-reanimated/issues/2774\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/software-mansion/react-native-reanimated/issues/2774</a></p>\n<h2 id=\"2-mysql\" style=\"position:relative;\"><a href=\"#2-mysql\" aria-label=\"2 mysql permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. MySQL</h2>\n<p>사실 백엔드쪽을 스스로 제작해보는 것은 이번이 처음이라, Django와 MySQL을 독학으로 공부할 수 밖에 없었다.</p>\n<h3 id=\"sql-vs-nosql\" style=\"position:relative;\"><a href=\"#sql-vs-nosql\" aria-label=\"sql vs nosql permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQL vs NoSQL</h3>\n<p><strong>SQL - 관계형 데이터베이스</strong>\n엄밀하게 말하자면 SQL은 Structured Query Language의 약자로 데이터베이스와 상호작용할 때 쓰이는 언어이지만, 일반적으로 관계형 데이터베이스를 말한다.</p>\n<ul>\n<li>SQL에는 엄격한 데이터 구조(schema)에 따라 데이터가 저장된다. 즉 하나의 테이블에 저장된 데이터는 모두 같은 구조를 가져야만 한다.</li>\n<li><strong>DB 정규화(Normalization)</strong> : SQL에는 각 데이터가 중복 없이 단 한번씩만 저장되어야 하기 때문에(이를 <strong>무결성</strong>이라고 한다), 구조 사이의 관계를 통해 여러 테이블에 분산된다.<br>\n정규화에 대한 좋은 설명 : <a href=\"https://mangkyu.tistory.com/110\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://mangkyu.tistory.com/110</a></li>\n<li>언제 사용하는가? : 관계를 맺고 있는 <strong>데이터가 자주 변경되고 수정되는 경우</strong> 혹은 데이터의 스키마가 명확하여 DB를 구성할 때 중요한 경우</li>\n<li>종류: Oracle, MySQL</li>\n</ul>\n<p><strong>NoSQL - 비관계형 데이터베이스</strong>\n관계형 DB의 한계를 해결하기 위해 제시된 방법으로, 스키마와 관계에 의존하지 않는다. 그렇기에 훨씬 유연하고 가변적인 데이터의 저장이 가능하고\n데이터를 가져오는 속도가 빨라진다.</p>\n<ul>\n<li>종류: MongoDB</li>\n</ul>\n<h3 id=\"default-table-지우기\" style=\"position:relative;\"><a href=\"#default-table-%EC%A7%80%EC%9A%B0%EA%B8%B0\" aria-label=\"default table 지우기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Default Table 지우기</h3>\n<p>django에서 기본으로 제공하는 테이블이 있어서 makemigrations 후 migrate하면 sql에 테이블이 이미 여러개가 생성되어 있다. 이번 앱에서는 관리자 기능이나 authorization이 필요가 없으므로 기본 app과 middleware를 지워줄 필요가 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># settings.py</span>\nINSTALLED_APPS <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\"># 'django.contrib.admin',</span>\n    <span class=\"token comment\"># 'django.contrib.auth',</span>\n    <span class=\"token comment\"># 'django.contrib.contenttypes',</span>\n    <span class=\"token comment\"># 'django.contrib.sessions',</span>\n    <span class=\"token comment\"># 'django.contrib.messages'</span>\n    <span class=\"token string\">'django.contrib.staticfiles'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'rest_framework'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\nMIDDLEWARE <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\"># 'django.middleware.security.SecurityMiddleware',</span>\n    <span class=\"token string\">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'django.middleware.common.CommonMiddleware'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># 'django.middleware.csrf.CsrfViewMiddleware',</span>\n    <span class=\"token comment\"># 'django.contrib.auth.middleware.AuthenticationMiddleware',</span>\n    <span class=\"token comment\"># 'django.contrib.messages.middleware.MessageMiddleware',</span>\n    <span class=\"token string\">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"django-server에서-mysql-db-이용\" style=\"position:relative;\"><a href=\"#django-server%EC%97%90%EC%84%9C-mysql-db-%EC%9D%B4%EC%9A%A9\" aria-label=\"django server에서 mysql db 이용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Django Server에서 MySQL DB 이용</h3>\n<p>Mysql을 처음 구동한다면 설치후 초기 user를 생성해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">  pip3 <span class=\"token function\">install</span> mysqlclient</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">  Mysql.server start\n  mysql -u root -p</code></pre></div>\n<h3 id=\"import-csv-file-to-mysql-db\" style=\"position:relative;\"><a href=\"#import-csv-file-to-mysql-db\" aria-label=\"import csv file to mysql db permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>import .csv file to MySQL DB</h3>\n<p>csv파일에 저장된 data를 DB에 넣는 방법은 두 가지가 있다. MySQLWorkbench를 이용하는 방법과, python code로 Django ORM을 통해 DB에 데이터를 추가하는 방법이다. 처음에는 전자를 이용했는데, DB를 직접 건드린다는 리스크가 있을 뿐더러 배포용 DB를 새로 만들 때에도 확장성이 부족하여 후자를 사용하는 편이 좋은 것 같다.</p>\n<p>manage.py가 있는 디렉토리에 db_insert.py를 아래처럼 만들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> django\n<span class=\"token keyword\">import</span> csv\n\nos<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>setdefault<span class=\"token punctuation\">(</span><span class=\"token string\">\"DJANGO_SETTINGS_MODULE\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'appname.settings.prod'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># python이 실행될 때 DJANGO_SETTINGS_MODULE라는 환경 변수에</span>\n<span class=\"token comment\"># 현재 프로젝트의 settings.py 파일 경로를 등록</span>\ndjango<span class=\"token punctuation\">.</span>setup<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># python manage.py shell 을 실행하는 것이랑 비슷한 방법이다. 즉 파이썬 파일에서도 django를 실행 시킬수 있다.</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">insert_data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data.csv'</span><span class=\"token punctuation\">,</span> newline<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> csvfile<span class=\"token punctuation\">:</span>\n        data_reader <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span>reader<span class=\"token punctuation\">(</span>csvfile<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> data_reader<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#csv파일의 각각의 row에 대해 각 원소를 row[i]로 접근하여 model.objects.create()로 생성해주면 된다.</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DATA UPLOADED SUCCESSFULY!'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"3-splash-screen-적용\" style=\"position:relative;\"><a href=\"#3-splash-screen-%EC%A0%81%EC%9A%A9\" aria-label=\"3 splash screen 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Splash screen 적용</h2>\n<p>앱 실행 후 처음 켜지는 화면을 바꿔주는 react-native-splash-screen 라이브러리. 본 프로젝트에 적용했을 때 splash screen이 <strong>검은색 화면</strong>으로 나오는 오류가 있어서, 공식 메뉴얼부터 기술블로그까지 구글링해가며 찾아봤지만 고쳐지지 않았다. 2주간의 삽질 끝에 찾아낸 이유는 splash screen에 들어가는 이미지의 사이즈가 너무 컸던 것.</p>\n<p>참고 :<br>\n<a href=\"https://velog.io/@dody_/React-Native-%EC%95%B1-%EC%95%84%EC%9D%B4%EC%BD%98-%EB%B0%94%EA%BE%B8%EA%B8%B0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://velog.io/@dody_/React-Native-앱-아이콘-바꾸기</a><br>\n<a href=\"https://appicon.co\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://appicon.co</a><br>\n<a href=\"https://ingg.dev/rn-splash/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ingg.dev/rn-splash/</a><br>\n<a href=\"https://stackoverflow.com/questions/63978396/launch-screen-not-working-on-ios-14-with-xcode-12\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://stackoverflow.com/questions/63978396/launch-screen-not-working-on-ios-14-with-xcode-12</a></p>","fields":{"slug":"/posts/usfk_bus_production_review","tagSlugs":null},"frontmatter":{"date":"2022-06-25","description":"React Native 라이브러리로 앱을, Django와 MySQL DB 기반으로 서버를 제작하며 배운 점들","tags":null,"category":"Projects","title":"USFK Bus Schedule 앱 제작 후기 및 Troubleshooting","socialImage":{"publicURL":"/static/aac190ab60d69e61ad7707c55ce0b40c/ryan.png"}}}},"pageContext":{"slug":"/posts/usfk_bus_production_review"}},"staticQueryHashes":["1722810546","251939775","401334301"]}